<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Color Sorter: C:/Users/awgia/OneDrive/Desktop/doxygen/src/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Color Sorter
   </div>
   <div id="projectbrief">Final Project for ME 507</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('main_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 seperate piles.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;PrintStream.h&gt;</code><br />
<code>#include &lt;Stepper.h&gt;</code><br />
<code>#include &quot;Adafruit_TCS34725.h&quot;</code><br />
<code>#include &quot;taskshare.h&quot;</code><br />
</div>
<p><a href="main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2d05bcc021d66ae0458c269139222edc"><td class="memItemLeft" align="right" valign="top"><a id="a2d05bcc021d66ae0458c269139222edc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>STEPS_PER_REV</b>&#160;&#160;&#160;200</td></tr>
<tr class="separator:a2d05bcc021d66ae0458c269139222edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a66ce0dbeb786aab299261210b7d7dfb7"><td class="memItemLeft" align="right" valign="top"><a id="a66ce0dbeb786aab299261210b7d7dfb7"></a>
Share&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>solenoid_on</b> (&quot;Solenoid on/off switch&quot;)</td></tr>
<tr class="separator:a66ce0dbeb786aab299261210b7d7dfb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44766bb45fccc1d696bb254833340d8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a44766bb45fccc1d696bb254833340d8b">steppermotor</a> (void *p_params)</td></tr>
<tr class="memdesc:a44766bb45fccc1d696bb254833340d8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used to control the stepper motor.  <a href="main_8cpp.html#a44766bb45fccc1d696bb254833340d8b">More...</a><br /></td></tr>
<tr class="separator:a44766bb45fccc1d696bb254833340d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff93ffa38625663c9f25403faec36858"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aff93ffa38625663c9f25403faec36858">solenoid</a> (void *p_params)</td></tr>
<tr class="memdesc:aff93ffa38625663c9f25403faec36858"><td class="mdescLeft">&#160;</td><td class="mdescRight">This code controls the solenoids to open and close.  <a href="main_8cpp.html#aff93ffa38625663c9f25403faec36858">More...</a><br /></td></tr>
<tr class="separator:aff93ffa38625663c9f25403faec36858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80506e98e88840ef03920c5546ca987"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ac80506e98e88840ef03920c5546ca987">ColorSensor</a> (void *p_params)</td></tr>
<tr class="memdesc:ac80506e98e88840ef03920c5546ca987"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads the color sensor.  <a href="main_8cpp.html#ac80506e98e88840ef03920c5546ca987">More...</a><br /></td></tr>
<tr class="separator:ac80506e98e88840ef03920c5546ca987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top"><a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup</b> ()</td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top"><a id="afe461d27b9c48d5921c00d521181f12f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>loop</b> ()</td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3619988432d5a48bcc544b9c5337871f"><td class="memItemLeft" align="right" valign="top"><a id="a3619988432d5a48bcc544b9c5337871f"></a>
Adafruit_TCS34725&#160;</td><td class="memItemRight" valign="bottom"><b>my_ColorSensor</b></td></tr>
<tr class="separator:a3619988432d5a48bcc544b9c5337871f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 seperate piles. </p>
<p>This functions reads the color of a ball on the a turn table and sends the color of the ball back to the Nucleo board using the SDA and SCL pins. Once the color of the ball is recived the motor is then sent a signal to turn to the correct postion based on the color of the ball. To make things easier, the turn table was split into 4 sections such that the motor will only be moving in 90 degree increments in order to get to the correct location.</p>
<dl class="section author"><dt>Author</dt><dd>Alexander Giannousis, Ali Yazdkhasti, Raul Gonzalez </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-Nov-16 Created file </dd>
<dd>
2020-Nov-18 Added tasks </dd>
<dd>
2020-Nov-27 Tried fixing solenoid task </dd>
<dd>
2020-Nov-28 Finally fixed solenoid task </dd>
<dd>
2020-Nov-29 Added Color Sensor task </dd></dl>

<p class="definition">Definition in file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac80506e98e88840ef03920c5546ca987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80506e98e88840ef03920c5546ca987">&#9670;&nbsp;</a></span>ColorSensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ColorSensor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads the color sensor. </p>
<p>This function reads the color sensor and send a signal to the stepper motor to turn until it has reached the correct location. <br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>used to store a value of the red detected </td></tr>
    <tr><td class="paramname">g</td><td>used to store a value of the green detected </td></tr>
    <tr><td class="paramname">b</td><td>used to store a value of the blue detected </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00188">188</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a id="aff93ffa38625663c9f25403faec36858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff93ffa38625663c9f25403faec36858">&#9670;&nbsp;</a></span>solenoid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solenoid </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This code controls the solenoids to open and close. </p>
<p>The signal to open comes depending on what color the color sensor has registered. The solenoid will wait until the stepper motor has turned to the correct location before opening up. (*NOTE: do not keep solenoid on for prolonged peroids of time this will burn it out)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PWMA</td><td>the input pin to the H-bridge chip for pulse modulation for the A side </td></tr>
    <tr><td class="paramname">PWMB</td><td>the input pin to the H-bridge chip for pulse modulation for the A side Because the we are using not using a DC motor we have no use for this, but the according to the datasheet they must be set to high. </td></tr>
    <tr><td class="paramname">Ain2</td><td>controls the 1st solenoid </td></tr>
    <tr><td class="paramname">Ain1</td><td>controls the 2nd solenoid </td></tr>
    <tr><td class="paramname">Bin1</td><td>controls the 3rd solenoid </td></tr>
    <tr><td class="paramname">Bin2</td><td>controls the 4th solenoid </td></tr>
  </table>
  </dd>
</dl>
<p>TB6612FNG motor driver input pins PWMA=&gt;D12() AIN_2=&gt;D11() AIN_1=&gt;D10() BIN_1=&gt;D09() BIN_2=&gt;D5() PWMB=&gt;D4()</p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00135">135</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a id="a44766bb45fccc1d696bb254833340d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44766bb45fccc1d696bb254833340d8b">&#9670;&nbsp;</a></span>steppermotor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void steppermotor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used to control the stepper motor. </p>
<p>The input for the stepper motor will come from the color sensor. Depending on which color is registered the stepper motor will turn until it has reached the correct spot and stop</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PWMA</td><td>the input pin to the H-bridge chip for pulse modulation for the A side </td></tr>
    <tr><td class="paramname">PWMB</td><td>the input pin to the H-bridge chip for pulse modulation for the A side Because the we are using a stepper motor we do not need the PWM signal pins so they can be set to high </td></tr>
    <tr><td class="paramname">Ain2</td><td>input pin for the A side of the motor driver </td></tr>
    <tr><td class="paramname">Ain1</td><td>input pin for the A side of the motor driver </td></tr>
    <tr><td class="paramname">Bin1</td><td>input pin for the B side of the motor driver </td></tr>
    <tr><td class="paramname">Bin2</td><td>input pin for the B side of the motor driver </td></tr>
  </table>
  </dd>
</dl>
<p>Ain pins are: D6=&gt;PWM_A (PB10) D3=&gt;Ain2 (PB3) D13=&gt;Ain1 (PA5) Bin pins are: D2=&gt;PWM_B (PA10) D8=&gt;Bin2 (PA9) D7=&gt;Bin1 (PA8) D10=&gt;Ain_sol (PB6)</p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00054">54</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_245f8ba1ed7978a4e1c59875b64610e2.html">awgia</a></li><li class="navelem"><a class="el" href="dir_b7422997002abf6b508fc05e8f52c38e.html">OneDrive</a></li><li class="navelem"><a class="el" href="dir_1c8202dc8bba0fda2b1136af55f12659.html">Desktop</a></li><li class="navelem"><a class="el" href="dir_d5018fc217f4f712bc6fdc2ac5e752d3.html">doxygen</a></li><li class="navelem"><a class="el" href="dir_41fdda748b60b893749178e2fec48df5.html">src</a></li><li class="navelem"><a class="el" href="main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
