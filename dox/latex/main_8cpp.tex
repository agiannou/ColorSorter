\hypertarget{main_8cpp}{}\doxysection{C\+:/\+Users/awgia/\+One\+Drive/\+Desktop/doxygen/src/main.cpp File Reference}
\label{main_8cpp}\index{C:/Users/awgia/OneDrive/Desktop/doxygen/src/main.cpp@{C:/Users/awgia/OneDrive/Desktop/doxygen/src/main.cpp}}


This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 seperate piles.  


{\ttfamily \#include $<$Arduino.\+h$>$}\newline
{\ttfamily \#include $<$Print\+Stream.\+h$>$}\newline
{\ttfamily \#include $<$Stepper.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Adafruit\+\_\+\+T\+C\+S34725.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}taskshare.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_a2d05bcc021d66ae0458c269139222edc}\label{main_8cpp_a2d05bcc021d66ae0458c269139222edc}} 
\#define {\bfseries S\+T\+E\+P\+S\+\_\+\+P\+E\+R\+\_\+\+R\+EV}~200
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_a66ce0dbeb786aab299261210b7d7dfb7}\label{main_8cpp_a66ce0dbeb786aab299261210b7d7dfb7}} 
Share$<$ bool $>$ {\bfseries solenoid\+\_\+on} (\char`\"{}Solenoid on/off switch\char`\"{})
\item 
void \mbox{\hyperlink{main_8cpp_a44766bb45fccc1d696bb254833340d8b}{steppermotor}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em Function used to control the stepper motor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_aff93ffa38625663c9f25403faec36858}{solenoid}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em This code controls the solenoids to open and close. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_ac80506e98e88840ef03920c5546ca987}{Color\+Sensor}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em This function reads the color sensor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}\label{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}} 
void {\bfseries setup} ()
\item 
\mbox{\Hypertarget{main_8cpp_afe461d27b9c48d5921c00d521181f12f}\label{main_8cpp_afe461d27b9c48d5921c00d521181f12f}} 
void {\bfseries loop} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_a3619988432d5a48bcc544b9c5337871f}\label{main_8cpp_a3619988432d5a48bcc544b9c5337871f}} 
Adafruit\+\_\+\+T\+C\+S34725 {\bfseries my\+\_\+\+Color\+Sensor}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 seperate piles. 

This functions reads the color of a ball on the a turn table and sends the color of the ball back to the Nucleo board using the S\+DA and S\+CL pins. Once the color of the ball is recived the motor is then sent a signal to turn to the correct postion based on the color of the ball. To make things easier, the turn table was split into 4 sections such that the motor will only be moving in 90 degree increments in order to get to the correct location.

\begin{DoxyAuthor}{Author}
Alexander Giannousis, Ali Yazdkhasti, Raul Gonzalez 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2020-\/Nov-\/16 Created file 

2020-\/Nov-\/18 Added tasks 

2020-\/Nov-\/27 Tried fixing solenoid task 

2020-\/Nov-\/28 Finally fixed solenoid task 

2020-\/Nov-\/29 Added Color Sensor task 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8cpp_ac80506e98e88840ef03920c5546ca987}\label{main_8cpp_ac80506e98e88840ef03920c5546ca987}} 
\index{main.cpp@{main.cpp}!ColorSensor@{ColorSensor}}
\index{ColorSensor@{ColorSensor}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{ColorSensor()}{ColorSensor()}}
{\footnotesize\ttfamily void Color\+Sensor (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



This function reads the color sensor. 

This function reads the color sensor and send a signal to the stepper motor to turn until it has reached the correct location. ~\newline



\begin{DoxyParams}{Parameters}
{\em r} & used to store a value of the red detected \\
\hline
{\em g} & used to store a value of the green detected \\
\hline
{\em b} & used to store a value of the blue detected \\
\hline
\end{DoxyParams}


Definition at line 188 of file main.\+cpp.

\mbox{\Hypertarget{main_8cpp_aff93ffa38625663c9f25403faec36858}\label{main_8cpp_aff93ffa38625663c9f25403faec36858}} 
\index{main.cpp@{main.cpp}!solenoid@{solenoid}}
\index{solenoid@{solenoid}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{solenoid()}{solenoid()}}
{\footnotesize\ttfamily void solenoid (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



This code controls the solenoids to open and close. 

The signal to open comes depending on what color the color sensor has registered. The solenoid will wait until the stepper motor has turned to the correct location before opening up. ($\ast$\+N\+O\+TE\+: do not keep solenoid on for prolonged peroids of time this will burn it out)


\begin{DoxyParams}{Parameters}
{\em P\+W\+MA} & the input pin to the H-\/bridge chip for pulse modulation for the A side \\
\hline
{\em P\+W\+MB} & the input pin to the H-\/bridge chip for pulse modulation for the A side Because the we are using not using a DC motor we have no use for this, but the according to the datasheet they must be set to high. \\
\hline
{\em Ain2} & controls the 1st solenoid \\
\hline
{\em Ain1} & controls the 2nd solenoid \\
\hline
{\em Bin1} & controls the 3rd solenoid \\
\hline
{\em Bin2} & controls the 4th solenoid \\
\hline
\end{DoxyParams}
T\+B6612\+F\+NG motor driver input pins P\+W\+MA=$>$D12() A\+I\+N\+\_\+2=$>$D11() A\+I\+N\+\_\+1=$>$D10() B\+I\+N\+\_\+1=$>$D09() B\+I\+N\+\_\+2=$>$D5() P\+W\+MB=$>$D4()

Definition at line 135 of file main.\+cpp.

\mbox{\Hypertarget{main_8cpp_a44766bb45fccc1d696bb254833340d8b}\label{main_8cpp_a44766bb45fccc1d696bb254833340d8b}} 
\index{main.cpp@{main.cpp}!steppermotor@{steppermotor}}
\index{steppermotor@{steppermotor}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{steppermotor()}{steppermotor()}}
{\footnotesize\ttfamily void steppermotor (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



Function used to control the stepper motor. 

The input for the stepper motor will come from the color sensor. Depending on which color is registered the stepper motor will turn until it has reached the correct spot and stop


\begin{DoxyParams}{Parameters}
{\em P\+W\+MA} & the input pin to the H-\/bridge chip for pulse modulation for the A side \\
\hline
{\em P\+W\+MB} & the input pin to the H-\/bridge chip for pulse modulation for the A side Because the we are using a stepper motor we do not need the P\+WM signal pins so they can be set to high \\
\hline
{\em Ain2} & input pin for the A side of the motor driver \\
\hline
{\em Ain1} & input pin for the A side of the motor driver \\
\hline
{\em Bin1} & input pin for the B side of the motor driver \\
\hline
{\em Bin2} & input pin for the B side of the motor driver \\
\hline
\end{DoxyParams}
Ain pins are\+: D6=$>$P\+W\+M\+\_\+A (P\+B10) D3=$>$Ain2 (P\+B3) D13=$>$Ain1 (P\+A5) Bin pins are\+: D2=$>$P\+W\+M\+\_\+B (P\+A10) D8=$>$Bin2 (P\+A9) D7=$>$Bin1 (P\+A8) D10=$>$Ain\+\_\+sol (P\+B6)

Definition at line 54 of file main.\+cpp.

