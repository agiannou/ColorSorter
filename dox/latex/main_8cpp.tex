\hypertarget{main_8cpp}{}\doxysection{main.\+cpp File Reference}
\label{main_8cpp}\index{main.cpp@{main.cpp}}


This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 separate piles.  


{\ttfamily \#include $<$Arduino.\+h$>$}\newline
{\ttfamily \#include $<$Print\+Stream.\+h$>$}\newline
{\ttfamily \#include $<$Stepper.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Adafruit\+\_\+\+T\+C\+S34725.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}taskshare.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_a2b2a3c06a072420b465dfdb0d4542b29}\label{main_8cpp_a2b2a3c06a072420b465dfdb0d4542b29}} 
\#define {\bfseries S\+T\+E\+P\+S\+\_\+\+P\+E\+R\+\_\+\+T\+U\+RN}~88
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_aac06e493be07f4e58ceac3b179d3e5b2}\label{main_8cpp_aac06e493be07f4e58ceac3b179d3e5b2}} 
Share$<$ bool $>$ {\bfseries turn\+\_\+complete} (\char`\"{}Indicator that stepper motor turn is complete\char`\"{})
\item 
void \mbox{\hyperlink{main_8cpp_a44766bb45fccc1d696bb254833340d8b_a44766bb45fccc1d696bb254833340d8b}{steppermotor}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em Function used to control the stepper motor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_aff93ffa38625663c9f25403faec36858_aff93ffa38625663c9f25403faec36858}{solenoid}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em This code controls the solenoids to open and close. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_ac80506e98e88840ef03920c5546ca987_ac80506e98e88840ef03920c5546ca987}{Color\+Sensor}} (void $\ast$p\+\_\+params)
\begin{DoxyCompactList}\small\item\em This function reads the color sensor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}\label{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}} 
void {\bfseries setup} ()
\item 
\mbox{\Hypertarget{main_8cpp_afe461d27b9c48d5921c00d521181f12f}\label{main_8cpp_afe461d27b9c48d5921c00d521181f12f}} 
void {\bfseries loop} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{main_8cpp_a3619988432d5a48bcc544b9c5337871f}\label{main_8cpp_a3619988432d5a48bcc544b9c5337871f}} 
Adafruit\+\_\+\+T\+C\+S34725 {\bfseries my\+\_\+\+Color\+Sensor}
\item 
\mbox{\Hypertarget{main_8cpp_ab4dd970446185d5c0e2ceb67f9348e9b}\label{main_8cpp_ab4dd970446185d5c0e2ceb67f9348e9b}} 
const int8\+\_\+t {\bfseries P\+W\+MA} = P\+B10
\item 
\mbox{\Hypertarget{main_8cpp_aeac4fa8274a848715ef5b2195424f905}\label{main_8cpp_aeac4fa8274a848715ef5b2195424f905}} 
const int8\+\_\+t {\bfseries Ain2} = P\+B3
\item 
\mbox{\Hypertarget{main_8cpp_ae3a8d0dcf0db0c72d87f73fa8c12cf4d}\label{main_8cpp_ae3a8d0dcf0db0c72d87f73fa8c12cf4d}} 
const int8\+\_\+t {\bfseries Ain1} = P\+A5
\item 
\mbox{\Hypertarget{main_8cpp_af8fe17dc1c350cd24f29c1988e900b90}\label{main_8cpp_af8fe17dc1c350cd24f29c1988e900b90}} 
const int8\+\_\+t {\bfseries P\+W\+MB} = P\+A10
\item 
\mbox{\Hypertarget{main_8cpp_aa3848b736694b314558c8c768dfaac46}\label{main_8cpp_aa3848b736694b314558c8c768dfaac46}} 
const int8\+\_\+t {\bfseries Bin2} = P\+A9
\item 
\mbox{\Hypertarget{main_8cpp_ae444de0969c01785df8d8479235e2180}\label{main_8cpp_ae444de0969c01785df8d8479235e2180}} 
const int8\+\_\+t {\bfseries Bin1} = P\+A8
\item 
\mbox{\Hypertarget{main_8cpp_aaf9f6c7b2bad575707c391076e6d8ef6}\label{main_8cpp_aaf9f6c7b2bad575707c391076e6d8ef6}} 
const int8\+\_\+t {\bfseries Ain1\+\_\+sol} = P\+B6
\item 
\mbox{\Hypertarget{main_8cpp_a15b54437077dfa103affa833c5159732}\label{main_8cpp_a15b54437077dfa103affa833c5159732}} 
const int8\+\_\+t {\bfseries Ain2\+\_\+sol} = P\+A7
\item 
\mbox{\Hypertarget{main_8cpp_a6c3729fd4de22175922ae47b03b656bf}\label{main_8cpp_a6c3729fd4de22175922ae47b03b656bf}} 
const int8\+\_\+t {\bfseries Bin1\+\_\+sol} = P\+C7
\item 
\mbox{\Hypertarget{main_8cpp_a6db1ca4b4a4638acaa765d923de12822}\label{main_8cpp_a6db1ca4b4a4638acaa765d923de12822}} 
const int8\+\_\+t {\bfseries Bin2\+\_\+sol} = P\+B4
\item 
\mbox{\Hypertarget{main_8cpp_a758caefad85ae18abd1908bcc64cef6a}\label{main_8cpp_a758caefad85ae18abd1908bcc64cef6a}} 
const int8\+\_\+t {\bfseries P\+W\+M\+A\+\_\+sol} = P\+A6
\item 
\mbox{\Hypertarget{main_8cpp_a8be65678eba196c6260834060aba5677}\label{main_8cpp_a8be65678eba196c6260834060aba5677}} 
const int8\+\_\+t {\bfseries P\+W\+M\+B\+\_\+sol} = P\+B5
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This is the main file for the color sorter project for ME 507. The objective of this function is to detect the color balls on a turn table and sort them out in 3 separate piles. 

This functions reads the color of a ball on the a turn table and sends the color of the ball back to the Nucleo board using the S\+DA and S\+CL pins. Once the color of the ball is recived the motor is then sent a signal to turn to the correct postion based on the color of the ball. To make things easier, the turn table was split into 4 sections such that the motor will only be moving in 90 degree increments in order to get to the correct location.

\begin{DoxyAuthor}{Author}
Alexander Giannousis, Ali Yazdkhasti, Raul Gonzalez 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2020-\/Nov-\/16 Created file 

2020-\/Nov-\/18 Added tasks 

2020-\/Nov-\/27 Tried fixing solenoid task 

2020-\/Nov-\/28 Finally fixed solenoid task 

2020-\/Nov-\/29 Added Color Sensor task 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8cpp_ac80506e98e88840ef03920c5546ca987_ac80506e98e88840ef03920c5546ca987}\label{main_8cpp_ac80506e98e88840ef03920c5546ca987_ac80506e98e88840ef03920c5546ca987}} 
\index{main.cpp@{main.cpp}!ColorSensor@{ColorSensor}}
\index{ColorSensor@{ColorSensor}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{ColorSensor()}{ColorSensor()}}
{\footnotesize\ttfamily void Color\+Sensor (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



This function reads the color sensor. 

This function reads the color sensor and send a signal to the stepper motor to turn until it has reached the correct location. ~\newline



\begin{DoxyParams}{Parameters}
{\em r} & used to store a value of the red detected \\
\hline
{\em g} & used to store a value of the green detected \\
\hline
{\em b} & used to store a value of the blue detected \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{main_8cpp_aff93ffa38625663c9f25403faec36858_aff93ffa38625663c9f25403faec36858}\label{main_8cpp_aff93ffa38625663c9f25403faec36858_aff93ffa38625663c9f25403faec36858}} 
\index{main.cpp@{main.cpp}!solenoid@{solenoid}}
\index{solenoid@{solenoid}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{solenoid()}{solenoid()}}
{\footnotesize\ttfamily void solenoid (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



This code controls the solenoids to open and close. 

The signal to open comes depending on what color the color sensor has registered. The solenoid will wait until the stepper motor has turned to the correct location before opening up. ($\ast$\+N\+O\+TE\+: do not keep solenoid on for prolonged peroids of time this will burn it out)


\begin{DoxyParams}{Parameters}
{\em P\+W\+MA} & the input pin to the H-\/bridge chip for pulse modulation for the A side \\
\hline
{\em P\+W\+MB} & the input pin to the H-\/bridge chip for pulse modulation for the A side \begin{DoxyVerb}     Because the we are using not using a DC motor we have no use for this, but 
     the according to the datasheet they must be set to high.
\end{DoxyVerb}
 \\
\hline
{\em Ain2} & controls the 1st solenoid \\
\hline
{\em Ain1} & controls the 2nd solenoid \\
\hline
{\em Bin1} & controls the 3rd solenoid \\
\hline
{\em Bin2} & controls the 4th solenoid \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{main_8cpp_a44766bb45fccc1d696bb254833340d8b_a44766bb45fccc1d696bb254833340d8b}\label{main_8cpp_a44766bb45fccc1d696bb254833340d8b_a44766bb45fccc1d696bb254833340d8b}} 
\index{main.cpp@{main.cpp}!steppermotor@{steppermotor}}
\index{steppermotor@{steppermotor}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{steppermotor()}{steppermotor()}}
{\footnotesize\ttfamily void steppermotor (\begin{DoxyParamCaption}\item[{void $\ast$}]{p\+\_\+params }\end{DoxyParamCaption})}



Function used to control the stepper motor. 

The input for the stepper motor will come from the color sensor. Depending on which color is registered the stepper motor will turn until it has reached the correct spot and stop


\begin{DoxyParams}{Parameters}
{\em P\+W\+MA} & the input pin to the H-\/bridge chip for pulse modulation for the A side \\
\hline
{\em P\+W\+MB} & the input pin to the H-\/bridge chip for pulse modulation for the A side \begin{DoxyVerb}     Because the we are using a stepper motor we do not need the PWM signal pins 
     so they can be set to high
\end{DoxyVerb}
 \\
\hline
{\em Ain2} & input pin for the A side of the motor driver \\
\hline
{\em Ain1} & input pin for the A side of the motor driver \\
\hline
{\em Bin1} & input pin for the B side of the motor driver \\
\hline
{\em Bin2} & input pin for the B side of the motor driver \\
\hline
\end{DoxyParams}
